--- Debugging Two-Step (Medcode -> SNOMED -> ICD-10) Mapping ---

Step 1: Getting a sample of raw codes from your sorted events...
Found 10000 unique raw codes to check.

Step 2: Loading the Medcode->SNOMED and SNOMED->ICD10 maps...
Loaded 247118 Medcode-to-SNOMED rules.
Loaded 958204 active SNOMED-to-ICD10 rules.

Step 3: Performing two-step INNER join to find end-to-end matches...

--- DEBUG RESULTS ---
Initial unique codes to check: 10000
Codes with a SNOMED mapping: 10000
Codes that completed the full mapping to ICD-10: 8836

✅ Success! Found 8836 complete matches. The mapping logic is working.
Here is a sample of the successful matches:
shape: (5, 3)
┌──────────────────┬───────────────────┬───────────┐
│ raw_code         ┆ SnomedCTConceptId ┆ mapTarget │
│ ---              ┆ ---               ┆ ---       │
│ str              ┆ str               ┆ str       │
╞══════════════════╪═══════════════════╪═══════════╡
│ 1787471000006114 ┆ 397807004         ┆ #NIS      │
│ 720521000006117  ┆ 443136000         ┆ #NIS      │
│ 284401015        ┆ 184096005         ┆ #NC       │
│ 4737411000006118 ┆ 185651006         ┆ #NIS      │
│ 475560018        ┆ 13868004          ┆ #NIS      │
└──────────────────┴───────────────────┴───────────┘

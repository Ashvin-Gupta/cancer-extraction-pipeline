--- Running Stage 3: Event Stream Generation ---
Step 1: Loading configuration and subject information...
  - Loading and processing codelists...
Step 3: Lazily scanning and standardizing raw events...
Step 4: Filtering events for cohort and mapping codes...
Step 4: Processing and writing data in memory-efficient batches...
  - Processing split: 'train' -> saving to 'train'
    - Processing shard 0 (1000 patients)...
  - Consolidating drug episodes...
